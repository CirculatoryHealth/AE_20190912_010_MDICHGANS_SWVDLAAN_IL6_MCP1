legend.position = "none")
ggsave(paste0(PLOT_loc, "/", Today, ".VlnPlot.",TARGET_D,".png"), plot = last_plot())
ggsave(paste0(PLOT_loc, "/", Today, ".VlnPlot.",TARGET_D,".ps"), plot = last_plot())
GenesOfInterest_TargetsA <- c("CCL2", "CCR2", "IL6", "IL6R", "ACTA2", "MYH11", "CD34", "CD14", "CD68", "CD3E", "CD4")
library(RColorBrewer)
DotPlot(scRNAseqData, features = GenesOfInterest_TargetsA,
cols = "RdBu")
ggsave(paste0(PLOT_loc, "/", Today, ".DotPlot.Targets.png"), plot = last_plot())
ggsave(paste0(PLOT_loc, "/", Today, ".DotPlot.Targets.ps"), plot = last_plot())
p1 <- DotPlot(scRNAseqData, features = GenesOfInterest_TargetsA,
cols = "RdBu")
p1 + theme(axis.text.x = element_text(angle = 45))
library(RColorBrewer)
p1 <- DotPlot(scRNAseqData, features = GenesOfInterest_TargetsA,
cols = "RdBu")
p1 + theme(axis.text.x = element_text(angle = 45))
ggsave(paste0(PLOT_loc, "/", Today, ".DotPlot.Targets.png"), plot = last_plot())
ggsave(paste0(PLOT_loc, "/", Today, ".DotPlot.Targets.ps"), plot = last_plot())
rm(p1)
FeaturePlot(scRNAseqData, features = c("MCP1", "CD14", "CD68"),
cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c("MCP1", "CD14"),
cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c("MCP1", "CD14"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c("CCL2", "CD14"),
cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c("CCL2", "CD14"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
RidgePlot(scRNAseqData, features = GenesOfInterest_TargetsA,
cols = "RdBu")
RidgePlot(scRNAseqData, features = GenesOfInterest_TargetsA)
RidgePlot(scRNAseqData, features = GenesOfInterest_TargetsA, ncol = 2)
DoHeatmap(subset(scRNAseqData, downsample = 100), features = GenesOfInterest_TargetsA, size = 3)
# GenesOfInterest_TargetsA <- c("CCL2", "CCR2", "IL6", "IL6R", "ACTA2", "MYH11", "CD34", "CD14", "CD68", "CD3E", "CD4")
GenesOfInterest_TargetsA <- c("CCL2", "CCR2", "IL6", "IL6R")
library(RColorBrewer)
p1 <- DotPlot(scRNAseqData, features = GenesOfInterest_TargetsA,
cols = "RdBu")
p1 + theme(axis.text.x = element_text(angle = 45))
GenesOfInterest_TargetsA <- c("CCL2", "CCR2", "IL6", "IL6R")
library(RColorBrewer)
p1 <- DotPlot(scRNAseqData, features = GenesOfInterest_TargetsA,
cols = "RdBu")
p1 + theme(axis.text.x = element_text(angle = 45))
ggsave(paste0(PLOT_loc, "/", Today, ".DotPlot.Targets.png"), plot = last_plot())
ggsave(paste0(PLOT_loc, "/", Today, ".DotPlot.Targets.ps"), plot = last_plot())
rm(p1)
DoHeatmap(subset(scRNAseqData, downsample = 100), features = GenesOfInterest_TargetsA, size = 3)
ggsave(paste0(PLOT_loc, "/", Today, ".HeatMap.Targets.png"), plot = last_plot())
ggsave(paste0(PLOT_loc, "/", Today, ".HeatMap.Targets.ps"), plot = last_plot())
DoHeatmap(scRNAseqData, features = GenesOfInterest_TargetsA, size = 3)
FeaturePlot(scRNAseqData, features = c("CCL2", "CD14"),
cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
split.by = "AsympSympt2G")
p1 <- DotPlot(scRNAseqData, features = GenesOfInterest_TargetsA,
cols = "RdBu")
p1 + theme(axis.text.x = element_text(angle = 45))
FeaturePlot(scRNAseqData, features = c("CCL2", "KIT"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
p1 + theme(axis.text.x = element_text(angle = 45))
DotPlot(scRNAseqData, features = GenesOfInterest_TargetsA,
cols = "RdBu")
FeaturePlot(scRNAseqData, features = c(TARGET_D, "CD79A"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
p1 <- DotPlot(scRNAseqData, features = GenesOfInterest_TargetsA,
cols = "RdBu")
p1 + theme(axis.text.x = element_text(angle = 45))
p1 <- DotPlot(scRNAseqData, features = GenesOfInterest_TargetsA,
cols = "RdBu")
p1 + theme(axis.text.x = element_text(angle = 45, hjust=1))
FeaturePlot(scRNAseqData, features = c(GenesOfInterest_TargetsA, "CD79A", "CD14", "CD68", "KIT"),
cols =  c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
combine = TRUE)
UMAPPlot(scRNAseqData, label = FALSE, pt.size = 1.25, label.size = 4, group.by = "ident",
repel = TRUE)
VlnPlot(scRNAseqData, features = TARGET_A_alt) +
xlab("cell communities") +
ylab(bquote("normalized "~italic(CCL2)~" expression")) +
theme(
axis.title.x = element_text(color = "#000000", size = 14, face = "bold"),
axis.title.y = element_text(color = "#000000", size = 14, face = "bold"),
legend.position = "none")
ggsave(paste0(PLOT_loc, "/", Today, ".VlnPlot.",TARGET_A,".png"), plot = last_plot())
ggsave(paste0(PLOT_loc, "/", Today, ".VlnPlot.",TARGET_A,".ps"), plot = last_plot())
VlnPlot(scRNAseqData, features = TARGET_B) +
xlab("cell communities") +
ylab(bquote("normalized "~italic(CCR2)~" expression")) +
theme(
axis.title.x = element_text(color = "#000000", size = 14, face = "bold"),
axis.title.y = element_text(color = "#000000", size = 14, face = "bold"),
legend.position = "none")
ggsave(paste0(PLOT_loc, "/", Today, ".VlnPlot.",TARGET_B,".png"), plot = last_plot())
ggsave(paste0(PLOT_loc, "/", Today, ".VlnPlot.",TARGET_B,".ps"), plot = last_plot())
VlnPlot(scRNAseqData, features = TARGET_C) +
xlab("cell communities") +
ylab(bquote("normalized "~italic(IL6)~" expression")) +
theme(
axis.title.x = element_text(color = "#000000", size = 14, face = "bold"),
axis.title.y = element_text(color = "#000000", size = 14, face = "bold"),
legend.position = "none")
ggsave(paste0(PLOT_loc, "/", Today, ".VlnPlot.",TARGET_C,".png"), plot = last_plot())
ggsave(paste0(PLOT_loc, "/", Today, ".VlnPlot.",TARGET_C,".ps"), plot = last_plot())
VlnPlot(scRNAseqData, features = TARGET_D) +
xlab("cell communities") +
ylab(bquote("normalized "~italic(IL6R)~" expression")) +
theme(
axis.title.x = element_text(color = "#000000", size = 14, face = "bold"),
axis.title.y = element_text(color = "#000000", size = 14, face = "bold"),
legend.position = "none")
ggsave(paste0(PLOT_loc, "/", Today, ".VlnPlot.",TARGET_D,".png"), plot = last_plot())
ggsave(paste0(PLOT_loc, "/", Today, ".VlnPlot.",TARGET_D,".ps"), plot = last_plot())
# GenesOfInterest_TargetsA <- c("CCL2", "CCR2", "IL6", "IL6R", "ACTA2", "MYH11", "CD34", "CD14", "CD68", "CD3E", "CD4")
GenesOfInterest_TargetsA <- c("CCL2", "CCR2", "IL6", "IL6R")
library(RColorBrewer)
p1 <- DotPlot(scRNAseqData, features = GenesOfInterest_TargetsA,
cols = "RdBu")
p1 + theme(axis.text.x = element_text(angle = 45, hjust=1))
ggsave(paste0(PLOT_loc, "/", Today, ".DotPlot.Targets.png"), plot = last_plot())
ggsave(paste0(PLOT_loc, "/", Today, ".DotPlot.Targets.ps"), plot = last_plot())
rm(p1)
DoHeatmap(scRNAseqData, features = GenesOfInterest_TargetsA, size = 3)
ggsave(paste0(PLOT_loc, "/", Today, ".HeatMap.Targets.png"), plot = last_plot())
ggsave(paste0(PLOT_loc, "/", Today, ".HeatMap.Targets.ps"), plot = last_plot())
# Visualize co-expression of two features simultaneously
FeaturePlot(scRNAseqData, features = c(TARGET_A_alt, "CD14"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c(TARGET_A_alt, "CD68"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c(TARGET_B, "CD14"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c(TARGET_B, "CD68"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c(TARGET_B, "CD79A"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c(TARGET_B, "CD79A"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c(TARGET_D, "CD79A"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c(TARGET_D, "CD79A"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c(GenesOfInterest_TargetsA, "CD79A", "CD14", "CD68", "KIT"),
cols =  c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
combine = TRUE)
ggsave(paste0(PLOT_loc, "/", Today, ".FeaturePlot.Targets.png"), plot = last_plot())
ggsave(paste0(PLOT_loc, "/", Today, ".FeaturePlot.Targets.ps"), plot = last_plot())
FeaturePlot(scRNAseqData, features = c("MMP2"), cols =  c("#ECECEC", "#DB003F"))
FeaturePlot(scRNAseqData, features = c("COL4A1"), cols =  c("#ECECEC", "#DB003F"))
FeaturePlot(scRNAseqData, features = c("COL4A2"), cols =  c("#ECECEC", "#DB003F"))
UMAPPlot(scRNAseqData, label = FALSE, pt.size = 1.25, label.size = 4, group.by = "ident",
repel = TRUE)
VlnPlot(scRNAseqData, features = TARGET_A_alt) +
xlab("cell communities") +
ylab(bquote("normalized "~italic(CCL2)~" expression")) +
theme(
axis.title.x = element_text(color = "#000000", size = 14, face = "bold"),
axis.title.y = element_text(color = "#000000", size = 14, face = "bold"),
legend.position = "none")
ggsave(paste0(PLOT_loc, "/", Today, ".VlnPlot.",TARGET_A,".png"), plot = last_plot())
ggsave(paste0(PLOT_loc, "/", Today, ".VlnPlot.",TARGET_A,".ps"), plot = last_plot())
VlnPlot(scRNAseqData, features = TARGET_B) +
xlab("cell communities") +
ylab(bquote("normalized "~italic(CCR2)~" expression")) +
theme(
axis.title.x = element_text(color = "#000000", size = 14, face = "bold"),
axis.title.y = element_text(color = "#000000", size = 14, face = "bold"),
legend.position = "none")
ggsave(paste0(PLOT_loc, "/", Today, ".VlnPlot.",TARGET_B,".png"), plot = last_plot())
ggsave(paste0(PLOT_loc, "/", Today, ".VlnPlot.",TARGET_B,".ps"), plot = last_plot())
VlnPlot(scRNAseqData, features = TARGET_C) +
xlab("cell communities") +
ylab(bquote("normalized "~italic(IL6)~" expression")) +
theme(
axis.title.x = element_text(color = "#000000", size = 14, face = "bold"),
axis.title.y = element_text(color = "#000000", size = 14, face = "bold"),
legend.position = "none")
ggsave(paste0(PLOT_loc, "/", Today, ".VlnPlot.",TARGET_C,".png"), plot = last_plot())
ggsave(paste0(PLOT_loc, "/", Today, ".VlnPlot.",TARGET_C,".ps"), plot = last_plot())
VlnPlot(scRNAseqData, features = TARGET_D) +
xlab("cell communities") +
ylab(bquote("normalized "~italic(IL6R)~" expression")) +
theme(
axis.title.x = element_text(color = "#000000", size = 14, face = "bold"),
axis.title.y = element_text(color = "#000000", size = 14, face = "bold"),
legend.position = "none")
ggsave(paste0(PLOT_loc, "/", Today, ".VlnPlot.",TARGET_D,".png"), plot = last_plot())
ggsave(paste0(PLOT_loc, "/", Today, ".VlnPlot.",TARGET_D,".ps"), plot = last_plot())
# GenesOfInterest_TargetsA <- c("CCL2", "CCR2", "IL6", "IL6R", "ACTA2", "MYH11", "CD34", "CD14", "CD68", "CD3E", "CD4")
GenesOfInterest_TargetsA <- c("CCL2", "CCR2", "IL6", "IL6R")
library(RColorBrewer)
p1 <- DotPlot(scRNAseqData, features = GenesOfInterest_TargetsA,
cols = "RdBu")
p1 + theme(axis.text.x = element_text(angle = 45, hjust=1))
ggsave(paste0(PLOT_loc, "/", Today, ".DotPlot.Targets.png"), plot = last_plot())
ggsave(paste0(PLOT_loc, "/", Today, ".DotPlot.Targets.ps"), plot = last_plot())
rm(p1)
# Visualize co-expression of two features simultaneously
FeaturePlot(scRNAseqData, features = c(TARGET_A_alt, "CD14"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c(TARGET_A_alt, "CD68"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c(TARGET_B, "CD14"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c(TARGET_B, "CD68"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c(TARGET_B, "CD79A"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c(TARGET_B, "CD79A"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c(TARGET_D, "CD79A"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c(TARGET_D, "CD79A"),
# cols = c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
# combine = TRUE,
blend = TRUE)
FeaturePlot(scRNAseqData, features = c(GenesOfInterest_TargetsA),
cols =  c("#ECECEC", "#DB003F", "#9A3480","#1290D9"),
combine = TRUE)
ggsave(paste0(PLOT_loc, "/", Today, ".FeaturePlot.Targets.png"), plot = last_plot())
ggsave(paste0(PLOT_loc, "/", Today, ".FeaturePlot.Targets.ps"), plot = last_plot())
FeaturePlot(scRNAseqData, features = c(TARGET_A_alt), cols =  c("#ECECEC", "#DB003F"))
FeaturePlot(scRNAseqData, features = c(TARGET_B), cols =  c("#ECECEC", "#DB003F"))
FeaturePlot(scRNAseqData, features = c(TARGET_C), cols =  c("#ECECEC", "#DB003F"))
FeaturePlot(scRNAseqData, features = c(TARGET_D), cols =  c("#ECECEC", "#DB003F"))
N_GENES=20552
EC.markers <- FindMarkers(object = scRNAseqData,
ident.1 = c("CD34+ EC I", "CD34+ EC II"),
ident.2 = c("CD14+CD68+ M I",
"CD14+CD68+ M II",
"CD14+CD68+ M III",
"CD3+CD8+ T I",
"CD3+CD8A+ T II ",
"CD3+CD8 T III",
"CD3+CD4+ T I",
"CD3+CD4+ T II",
"CD3+CD4+ T III",
"Mixed I",
"Mixed II",
"ACTA2+ SMC",
"NCAM1+ NK",
"KIT+ MC",
"CD79A+ B I",
"CD79A+ B II"))
DT::datatable(EC.markers)
EC_Volcano_TargetsA = EnhancedVolcano(EC.markers,
lab = rownames(EC.markers),
x = "avg_logFC",
y = "p_val_adj",
selectLab = GenesOfInterest_TargetsA,
axisLabSize = 12,
xlab = "average fold-change",
title = "EC markers\n(EC community vs the rest)",
titleLabSize = 14,
pCutoff = 0.05/N_GENES, # 20552 genes
FCcutoff = 1.25,
transcriptPointSize = 1.5,
transcriptLabSize = 3.0,
legend=c('NS','avg. fold-change','P',
'P & avg. fold-change'),
legendPosition = "right",
legendLabSize = 10,
legendIconSize = 3.0,
drawConnectors = TRUE,
widthConnectors = 0.2,
colConnectors = "#595A5C",
gridlines.major = FALSE,
gridlines.minor = FALSE)
EC_Volcano_TargetsA
ggsave(paste0(PLOT_loc, "/", Today, ".Volcano.EC.DEG.Targets.pdf"),
plot = EC_Volcano_TargetsA)
temp = subset(EC.markers, (rownames(EC.markers)=="CCL2" | rownames(EC.markers)=="CCR2" | rownames(EC.markers)=="IL6" | rownames(EC.markers)=="IL6R"))
DT::datatable(temp)
rm(temp)
N_GENES=20552
MAC.markers <- FindMarkers(object = scRNAseqData,
ident.1 = c("CD14+CD68+ M I",
"CD14+CD68+ M II",
"CD14+CD68+ M III"),
ident.2 = c(#"CD14+CD68+ M I",
#"CD14+CD68+ M II",
#"CD14+CD68+ M III",
"CD3+CD8+ T I",
"CD3+CD8A+ T II ",
"CD3+CD8 T III",
"CD3+CD4+ T I",
"CD3+CD4+ T II",
"CD3+CD4+ T III",
"CD34+ EC I", "CD34+ EC II",
"Mixed I",
"Mixed II",
"ACTA2+ SMC",
"NCAM1+ NK",
"KIT+ MC",
"CD79A+ B I",
"CD79A+ B II"))
DT::datatable(EC.markers)
N_GENES=20552
MAC.markers <- FindMarkers(object = scRNAseqData,
ident.1 = c("CD14+CD68+ M I",
"CD14+CD68+ M II",
"CD14+CD68+ M III"),
ident.2 = c(#"CD14+CD68+ M I",
#"CD14+CD68+ M II",
#"CD14+CD68+ M III",
"CD3+CD8+ T I",
"CD3+CD8A+ T II ",
"CD3+CD8 T III",
"CD3+CD4+ T I",
"CD3+CD4+ T II",
"CD3+CD4+ T III",
"CD34+ EC I", "CD34+ EC II",
"Mixed I",
"Mixed II",
"ACTA2+ SMC",
"NCAM1+ NK",
"KIT+ MC",
"CD79A+ B I",
"CD79A+ B II"))
DT::datatable(MAC.markers)
MAC_Volcano_TargetsA = EnhancedVolcano(MAC.markers,
lab = rownames(EC.markers),
x = "avg_logFC",
y = "p_val_adj",
selectLab = GenesOfInterest_TargetsA,
axisLabSize = 12,
xlab = "average fold-change",
title = "EC markers\n(EC community vs the rest)",
titleLabSize = 14,
pCutoff = 0.05/N_GENES, # 20552 genes
FCcutoff = 1.25,
transcriptPointSize = 1.5,
transcriptLabSize = 3.0,
legend=c('NS','avg. fold-change','P',
'P & avg. fold-change'),
legendPosition = "right",
legendLabSize = 10,
legendIconSize = 3.0,
drawConnectors = TRUE,
widthConnectors = 0.2,
colConnectors = "#595A5C",
gridlines.major = FALSE,
gridlines.minor = FALSE)
N_GENES=20552
MAC.markers <- FindMarkers(object = scRNAseqData,
ident.1 = c("CD14+CD68+ M I",
"CD14+CD68+ M II",
"CD14+CD68+ M III"),
ident.2 = c(#"CD14+CD68+ M I",
#"CD14+CD68+ M II",
#"CD14+CD68+ M III",
"CD3+CD8+ T I",
"CD3+CD8A+ T II ",
"CD3+CD8 T III",
"CD3+CD4+ T I",
"CD3+CD4+ T II",
"CD3+CD4+ T III",
"CD34+ EC I", "CD34+ EC II",
"Mixed I",
"Mixed II",
"ACTA2+ SMC",
"NCAM1+ NK",
"KIT+ MC",
"CD79A+ B I",
"CD79A+ B II"))
DT::datatable(MAC.markers)
MAC_Volcano_TargetsA = EnhancedVolcano(MAC.markers,
lab = rownames(MAC.markers),
x = "avg_logFC",
y = "p_val_adj",
selectLab = GenesOfInterest_TargetsA,
axisLabSize = 12,
xlab = "average fold-change",
title = "Macrophage markers\n(Macrophage communities vs the rest)",
titleLabSize = 14,
pCutoff = 0.05/N_GENES, # 20552 genes
FCcutoff = 1.25,
transcriptPointSize = 1.5,
transcriptLabSize = 3.0,
legend=c('NS','avg. fold-change','P',
'P & avg. fold-change'),
legendPosition = "right",
legendLabSize = 10,
legendIconSize = 3.0,
drawConnectors = TRUE,
widthConnectors = 0.2,
colConnectors = "#595A5C",
gridlines.major = FALSE,
gridlines.minor = FALSE)
MAC_Volcano_TargetsA
ggsave(paste0(PLOT_loc, "/", Today, ".Volcano.MAC.DEG.Targets.pdf"),
plot = MAC_Volcano_TargetsA)
temp = subset(MAC.markers, (rownames(MAC.markers)=="CCL2" | rownames(MAC.markers)=="CCR2" | rownames(MAC.markers)=="IL6" | rownames(MAC.markers)=="IL6R"))
DT::datatable(temp)
rm(temp)
B.markers <- FindMarkers(object = scRNAseqData,
ident.1 = c("CD79A+ B I",
"CD79A+ B II"),
ident.2 = c("CD14+CD68+ M I",
"CD14+CD68+ M II",
"CD14+CD68+ M III",
"CD3+CD8+ T I",
"CD3+CD8A+ T II ",
"CD3+CD8 T III",
"CD3+CD4+ T I",
"CD3+CD4+ T II",
"CD3+CD4+ T III",
"CD34+ EC I", "CD34+ EC II",
"Mixed I",
"Mixed II",
"ACTA2+ SMC",
"NCAM1+ NK",
"KIT+ MC"))#,
#"CD79A+ B I",
#"CD79A+ B II"))
DT::datatable(B.markers)
B_Volcano_TargetsA = EnhancedVolcano(B.markers,
lab = rownames(B.markers),
x = "avg_logFC",
y = "p_val_adj",
selectLab = GenesOfInterest_TargetsA,
axisLabSize = 12,
xlab = "average fold-change",
title = "B-cell markers\n(B-cells vs the rest)",
titleLabSize = 14,
pCutoff = 0.05/N_GENES,
FCcutoff = 1.25,
transcriptPointSize = 1.5,
transcriptLabSize = 3.0,
legend=c('NS','avg. fold-change','P',
'P & avg. fold-change'),
legendPosition = "right",
legendLabSize = 10,
legendIconSize = 3.0,
drawConnectors = TRUE,
widthConnectors = 0.2,
colConnectors = "#595A5C",
gridlines.major = FALSE,
gridlines.minor = FALSE)
B_Volcano_TargetsA
ggsave(paste0(PLOT_loc, "/", Today, ".Volcano.Bcell.DEG.Targets.pdf"),
plot = B_Volcano_TargetsA)
temp = subset(B.markers, (rownames(B.markers)=="CCL2" | rownames(B.markers)=="CCR2" | rownames(B.markers)=="IL6" | rownames(B.markers)=="IL6R"))
DT::datatable(temp)
rm(temp)
sessionInfo()
save.image(paste0(PROJECT_loc, "/",Today,".",PROJECTNAME,".scrnaseq_results.RData"))
?fwrite
fwrite(MAC.markers, file = paste0(OUT_loc,"/",Today,"/.MAC.markers.txt"),
quote = "", sep = "\t", na ="", dec = ".",
showProgress = TRUE, verbose = TRUE,
compress = c("gzip"))
fwrite(MAC.markers, file = paste0(OUT_loc,"/",Today,"/.MAC.markers.txt"),
quote = FALSE, sep = "\t", na ="", dec = ".",
showProgress = TRUE, verbose = TRUE,
compress = c("gzip"))
fwrite(MAC.markers, file = paste0(OUT_loc,"/",Today,".MAC.markers.txt.gz"),
quote = FALSE, sep = "\t", na ="", dec = ".",
showProgress = TRUE, verbose = TRUE,
compress = c("gzip"))
rownames(MAC.markers)
MAC.markers <- data.frame(Gene = rownames(MAC.markers), MAC.markers)
head(MAC.markers)
fwrite(MAC.markers, file = paste0(OUT_loc,"/",Today,".MAC.markers.txt.gz"),
quote = FALSE, sep = "\t", na ="", dec = ".",
showProgress = TRUE, verbose = TRUE,
compress = c("gzip"))
save.image(paste0(PROJECT_loc, "/",Today,".",PROJECTNAME,".scrnaseq_results.RData"))
